function [optimalReferenceDepth, optimalMantleDensity, ...
    optimalCrustDensity, optimalElasticThickness] = ...
    successiveOptimization(baseReferenceDepth, baseMantleDensity, ...
    baseCrustDensity, baseElasticThickness, bulkModulus, shearModulus, ...
    radius, mass, g0, topography, mask, measuredThickness, ...
    depthAlterations, mantleDensityAlterations, crustDensityAlterations,...
    thicknessAlterations)
    
    disp("Starting successive optimization.")
    %% Reference depth
    disp("Starting optimization of reference depth.")
    sizeDepthAlterations = size(depthAlterations);
    errors = zeros(1,sizeDepthAlterations(2));
    indexes = 1:sizeDepthAlterations(2);

    for index = indexes
        referenceDepth = baseReferenceDepth + depthAlterations(index);
        crustGravity = calculateLowerCrustGravity(radius, ...
            referenceDepth, baseCrustDensity, mass);
        airyCrust = airyEqualPressures(topography, baseCrustDensity, ...
            baseMantleDensity, referenceDepth, g0, crustGravity);
        flexureCrust = flexureThinShell(airyCrust, bulkModulus,...
            shearModulus, baseElasticThickness, baseMantleDensity, ...
            baseCrustDensity, g0, radius);
        errors(index) = selectiveRMSE(flexureCrust, measuredThickness, mask);
    end

    optimalReferenceDepth = baseReferenceDepth + ...
        depthAlterations(errors == min(errors, [], "all"));

    %% Densities
    disp("Starting optimization of densities.")
    sizeMantleDensityAlterations = size(mantleDensityAlterations);
    sizeCrustDensityAlterations = size(crustDensityAlterations);
    errors = zeros(sizeMantleDensityAlterations(2), ...
        sizeCrustDensityAlterations(2));
    mantleIndexes = 1:sizeMantleDensityAlterations(2);
    crustIndexes = 1:sizeCrustDensityAlterations(2);

    for mantleIndex = mantleIndexes
        mantleDensity = baseMantleDensity + ...
            mantleDensityAlterations(mantleIndex);
        for crustIndex = crustIndexes
            crustDensity = baseCrustDensity + ...
                crustDensityAlterations(crustIndex);
            crustGravity = calculateLowerCrustGravity(radius, ...
                optimalReferenceDepth, crustDensity, mass);
            airyCrust = airyEqualPressures(topography, crustDensity, ...
                mantleDensity, optimalReferenceDepth, g0, crustGravity);
            flexureCrust = flexureThinShell(airyCrust, bulkModulus,...
                shearModulus, baseElasticThickness, mantleDensity, ...
                crustDensity, g0, radius);
            errors(mantleIndex, crustIndex) = ...
                selectiveRMSE(flexureCrust, measuredThickness, mask);
        end
    end

    [optimumMantleIndex, optimumCrustIndex] = ...
        find(errors == min(errors, [], "all"));
    optimalMantleDensity = baseMantleDensity + ...
        mantleDensityAlterations(optimumMantleIndex);
    optimalCrustDensity = baseCrustDensity + ...
        crustDensityAlterations(optimumCrustIndex);

    %% Elastic thickness
    disp("Starting optimization of elastic thickness.")
    sizeThicknessAlterations = size(thicknessAlterations);
    errors = zeros(1,sizeThicknessAlterations(2));
    indexes = 1:sizeThicknessAlterations(2);

    for index = indexes
        elasticThickness = baseElasticThickness + thicknessAlterations(index);
        crustGravity = calculateLowerCrustGravity(radius, ...
            optimalReferenceDepth, optimalCrustDensity, mass);
        airyCrust = airyEqualPressures(topography, optimalCrustDensity, ...
            optimalMantleDensity, optimalReferenceDepth, g0, crustGravity);
        flexureCrust = flexureThinShell(airyCrust, bulkModulus,...
            shearModulus, elasticThickness, optimalMantleDensity, ...
            optimalCrustDensity, g0, radius);
        errors(index) = selectiveRMSE(flexureCrust, measuredThickness, mask);
    end
    disp("Finished successive optimization.")

    optimalElasticThickness = baseElasticThickness + ...
        thicknessAlterations(errors == min(errors, [], "all"));
end

